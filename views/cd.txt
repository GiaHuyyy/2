//Servlet
//DanhSach
private EntityManagerFactoryUtil entityManagerFactoryUtil;
	private NhaCungCapDAO cungCapDAO;
	private DienThoaiDAO dienThoaiDAO;

public void init(ServletConfig config) throws ServletException {
		super.init(config);
		this.entityManagerFactoryUtil = new EntityManagerFactoryUtil();
		this.cungCapDAO = new NhaCungCapImpl(this.entityManagerFactoryUtil.getEnManager());
		this.dienThoaiDAO = new DienThoaiImpl(this.entityManagerFactoryUtil.getEnManager());
	}

protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		// TODO Auto-generated method stub
		List<NhaCungCap> listNCC = new ArrayList<>();
		List<DienThoai> listDT = new ArrayList<>();
		listDT = dienThoaiDAO.findAll();
		
		String search = request.getParameter("search");
		if(search!=null && !search.isEmpty()) {
			listNCC = cungCapDAO.searchNhaCungCap(search);
		}else {
			listNCC = cungCapDAO.findAll();
		}

		request.setAttribute("listNCC", listNCC);
		request.setAttribute("listDT", listDT);
		request.getRequestDispatcher("views/DanhSachDienThoaiNCC.jsp").forward(request, response);
	}

// Them
protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		List<NhaCungCap> listNCC = new ArrayList<>();
		listNCC = cungCapDAO.findAll();

		request.setAttribute("listNCC", listNCC);
		request.getRequestDispatcher("views/DienThoaiForm.jsp").forward(request, response);
	}
protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		String tenDienThoai = request.getParameter("ten");
		int namSanXuat = Integer.parseInt(request.getParameter("nam"));
		String cauHinh = request.getParameter("cauhinh");
		String nhacungcapId = request.getParameter("nhacungcap");
		String hinhAnh = request.getParameter("hinhanh");

		DienThoai dienThoai = new DienThoai(tenDienThoai, namSanXuat, cauHinh, new NhaCungCap(nhacungcapId), hinhAnh);

		this.dienThoaiDAO.addDienThoai(dienThoai);
		response.sendRedirect("DanhSachDienThoaiNCCServlet");
	}
//QuanLy
protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		List<DienThoai> listDT = new ArrayList<>();
		listDT = dienThoaiDAO.findAll();

		request.setAttribute("listDT", listDT);
		request.getRequestDispatcher("views/QuanLyForm.jsp").forward(request, response);
	}
protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		String action = request.getParameter("action");
		if(action != null && action.startsWith("delete_")) {
			String maDT = action.substring("delete_".length());
			int id = Integer.parseInt(maDT);
			this.dienThoaiDAO.deleteDienThoai(id);
			response.sendRedirect("DanhSachDienThoaiNCCServlet");
		} else if (action != null && action.startsWith("update_")) {
			String maDT = action.substring("update_".length());
			int id = Integer.parseInt(maDT);
			
			DienThoai dienThoai = dienThoaiDAO.findById(id);
			
			request.setAttribute("dienthoai", dienThoai);
			request.getRequestDispatcher("views/DienThoaiFormUpdate.jsp").forward(request, response);
		}

	}
//Update
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String maDTStr = request.getParameter("ma");
		int maDT = Integer.parseInt(maDTStr);
		String tenDienThoai = request.getParameter("ten");
		int namSanXuat = Integer.parseInt(request.getParameter("nam"));
		String cauHinh = request.getParameter("cauhinh");
		String nhacungcapId = request.getParameter("nhacungcap");
		String hinhAnh = request.getParameter("hinhanh");

		DienThoai dienThoai = new DienThoai(maDT, tenDienThoai, namSanXuat, cauHinh, new NhaCungCap(nhacungcapId), hinhAnh);

		this.dienThoaiDAO.updateDienThoai(dienThoai);
		response.sendRedirect("DanhSachDienThoaiNCCServlet");
	}

// validator
// Validator
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        Validator validator = factory.getValidator();
        Set<ConstraintViolation<DienThoai>> violations = validator.validate(dienThoai);

        if (!violations.isEmpty()) {
            StringBuilder errorMessage = new StringBuilder();
            for (ConstraintViolation<DienThoai> violation : violations) {
                System.out.println(violation.getMessage());
            }
            request.getRequestDispatcher("views/DienThoai.jsp").forward(request, response);
        } else {
            this.dienThoaiDAO.addDienThoai(dienThoai);
            response.sendRedirect("DanhSachDienThoaiNCCServlet");
        }
